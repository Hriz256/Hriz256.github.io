!function(){"use strict";var c=require("./svgWriterTag.js"),f=require("./svgWriterUtils").getTransform;module.exports={externalizeStyles:function(t){var e,s,r,i,n,a=t.currentOMNode,o=a.shifted?(t._shiftContentX||0)+(t._shiftCropRectX||0):0,u=a.shifted?(t._shiftContentY||0)+(t._shiftCropRectY||0):0;if(a.style&&a.style.mask&&a.style.mask.ref){if(t.masks=t.masks||{},i=[e=a.style.mask.ref,o,u],!(r=t.masks[i])&&t.svgOM.resources&&t.svgOM.resources.masks[e]){if(t.currentOMNode=t.svgOM.resources.masks[e],n=t.currentOMNode.name,s=t.ID.getUnique("mask",n),t.currentOMNode.translateTX=o,t.currentOMNode.translateTY=u,r=c.make(t),a.shifted&&(o||u)){var l=new c("g",{transform:f(null,o,u,t.precision,!0)});l.children=r.children,r.children=[l]}t.masks[i]=r,t.currentOMNode=a,r.setAttribute("id",s),!t.minify&&n&&s!=n&&r.setAttribute("data-name",n)}r&&t.omStylesheet.def(r,function(e){t.omStylesheet.getStyleBlock(a).addRule("mask","url(#"+t.prefix+e.getAttribute("id")+")")})}}}}();