!function(e,t){"function"==typeof define&&define.amd?define(["./ResizeSensor.js"],t):"object"==typeof exports?module.exports=t(require("./ResizeSensor.js")):e.ElementQueries=t(e.ResizeSensor)}(this,function(y){var t=function(){var m=!1,h=[];function s(e){e||(e=document.documentElement);var t=window.getComputedStyle(e,null).fontSize;return parseFloat(t)||16}function c(e,t){var n=t.split(/\d/),i=n[n.length-1];switch(t=parseFloat(t),i){case"px":return t;case"em":return t*s(e);case"rem":return t*s();case"vw":return t*document.documentElement.clientWidth/100;case"vh":return t*document.documentElement.clientHeight/100;case"vmin":case"vmax":var r=document.documentElement.clientWidth/100,o=document.documentElement.clientHeight/100;return t*(0,Math["vmin"===i?"min":"max"])(r,o);default:return t}}function n(e){this.element=e,this.options={};var t,n,i,r,o,s,a,d=0,u=0;this.addOption=function(e){var t=[e.mode,e.property,e.value].join(",");this.options[t]=e};var l=["min-width","min-height","max-width","max-height"];this.call=function(){for(t in d=this.element.offsetWidth,u=this.element.offsetHeight,o={},this.options)this.options.hasOwnProperty(t)&&(n=this.options[t],i=c(this.element,n.value),r="width"==n.property?d:u,a=n.mode+"-"+n.property,s="","min"==n.mode&&i<=r&&(s+=n.value),"max"==n.mode&&r<=i&&(s+=n.value),o[a]||(o[a]=""),s&&-1===(" "+o[a]+" ").indexOf(" "+s+" ")&&(o[a]+=" "+s));for(var e in l)l.hasOwnProperty(e)&&(o[l[e]]?this.element.setAttribute(l[e],o[l[e]].substr(1)):this.element.removeAttribute(l[e]))}}function a(e,t){e.elementQueriesSetupInformation?e.elementQueriesSetupInformation.addOption(t):(e.elementQueriesSetupInformation=new n(e),e.elementQueriesSetupInformation.addOption(t),e.elementQueriesSensor=new y(e,function(){e.elementQueriesSetupInformation.call()})),e.elementQueriesSetupInformation.call(),m&&h.indexOf(e)<0&&h.push(e)}var d={};function u(){var e;if(document.querySelectorAll&&(e=document.querySelectorAll.bind(document)),e||"undefined"==typeof $$||(e=$$),e||"undefined"==typeof jQuery||(e=jQuery),!e)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return e}function r(i){var r=[],o=[],s=[],a=0,d=-1,u=[];for(var e in i.children)if(i.children.hasOwnProperty(e)&&i.children[e].tagName&&"img"===i.children[e].tagName.toLowerCase()){r.push(i.children[e]);var t=i.children[e].getAttribute("min-width")||i.children[e].getAttribute("data-min-width"),n=i.children[e].getAttribute("data-src")||i.children[e].getAttribute("url");s.push(n);var l={minWidth:t};o.push(l),i.children[e].style.display=t?"none":(a=r.length-1,"block")}function c(){var e,t=!1;for(e in r)r.hasOwnProperty(e)&&o[e].minWidth&&i.offsetWidth>o[e].minWidth&&(t=e);if(t||(t=a),d!=t)if(u[t])r[d].style.display="none",r[t].style.display="block",d=t;else{var n=new Image;n.onload=function(){r[t].src=s[t],r[d].style.display="none",r[t].style.display="block",u[t]=!0,d=t},n.src=s[t]}else r[t].src=s[t]}d=a,i.resizeSensor=new y(i,c),c(),m&&h.push(i)}var l=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,f=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function o(e){var t,n,i,r,o,s;for(e=e.replace(/'/g,'"');null!==(t=l.exec(e));)for(n=t[1]+t[3],attrs=t[2];null!==(attrMatch=f.exec(attrs));)i=n,r=attrMatch[1],o=attrMatch[2],s=attrMatch[3],void 0===d[r]&&(d[r]={}),void 0===d[r][o]&&(d[r][o]={}),void 0===d[r][o][s]?d[r][o][s]=i:d[r][o][s]+=","+i}function p(e){var t="";if(e)if("string"==typeof e)-1===(e=e.toLowerCase()).indexOf("min-width")&&-1===e.indexOf("max-width")||o(e);else for(var n=0,i=e.length;n<i;n++)1===e[n].type?-1!==(t=e[n].selectorText||e[n].cssText).indexOf("min-height")||-1!==t.indexOf("max-height")?o(t):-1===t.indexOf("min-width")&&-1===t.indexOf("max-width")||o(t):4===e[n].type&&p(e[n].cssRules||e[n].rules)}var v=!1;this.init=function(e){m=void 0!==e&&e;for(var t=0,n=document.styleSheets.length;t<n;t++)try{p(document.styleSheets[t].cssRules||document.styleSheets[t].rules||document.styleSheets[t].cssText)}catch(e){if("SecurityError"!==e.name)throw e}if(!v){var i=document.createElement("style");i.type="text/css",i.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img { width: 100%;}",document.getElementsByTagName("head")[0].appendChild(i),v=!0}!function(){var e=u();for(var t in d)if(d.hasOwnProperty(t))for(var n in d[t])if(d[t].hasOwnProperty(n))for(var i in d[t][n])if(d[t][n].hasOwnProperty(i))for(var r=e(d[t][n][i]),o=0,s=r.length;o<s;o++)a(r[o],{mode:t,property:n,value:i})}(),function(){for(var e=u()("[data-responsive-image],[responsive-image]"),t=0,n=e.length;t<n;t++)r(e[t])}()},this.update=function(e){this.init(e)},this.detach=function(){if(!this.withTracking)throw"withTracking is not enabled. We can not detach elements since we don not store it.Use ElementQueries.withTracking = true; before domready or call ElementQueryes.update(true).";for(var e;e=h.pop();)t.detach(e);h=[]}};t.update=function(e){t.instance.update(e)},t.detach=function(e){e.elementQueriesSetupInformation?(e.elementQueriesSensor.detach(),delete e.elementQueriesSetupInformation,delete e.elementQueriesSensor):e.resizeSensor&&(e.resizeSensor.detach(),delete e.resizeSensor)},t.withTracking=!1,t.init=function(){t.instance||(t.instance=new t),t.instance.init(t.withTracking)};return t.listen=function(){!function(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",e,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var t=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(e(),clearInterval(t))},10);else window.onload=e}(t.init)},"undefined"!=typeof module&&void 0!==module.exports?module.exports=t:(window.ElementQueries=t).listen(),t});